#ifndef _MIE_H_
#define _MIE_H_

#include <iostream>
#include "complex.h"

#define NUM_ANGLE 90

//const float CIE_R[81] = { 0.0000, 0.0001, 0.0001, 0.0002, 0.0003, 0.0005, 0.0008, 0.0014, 0.0021, 0.0027, 0.0022, 0.0004, -0.0026, -0.0067, -0.0121, -0.0187, -0.0261, -0.0332, -0.0393, -0.0447, -0.0494, -0.0536, -0.0581, -0.0641, -0.0714, -0.0812, -0.0890, -0.0936, -0.0926, -0.0847, -0.0710, -0.0532, -0.0315, -0.0061, 0.0228, 0.0551, 0.0906, 0.1284, 0.1677, 0.2072, 0.2456, 0.2799, 0.3093, 0.3318, 0.3443, 0.3476, 0.3397, 0.3227, 0.2971, 0.2635, 0.2268, 0.1923, 0.1597, 0.1291, 0.1017, 0.0786, 0.0593, 0.0437, 0.0315, 0.0229, 0.0169, 0.0119, 0.0082, 0.0057, 0.0041, 0.0029, 0.0021, 0.0015, 0.0011, 0.0007, 0.0005, 0.0004, 0.0003, 0.0002, 0.0001, 0.0001, 0.0001, 0.0000, 0.0000, 0.0000, 0.0000 };
//const float CIE_G[81] = { 0.0000, 0.0000, 0.0000, -0.0001, -0.0001, -0.0002, -0.0004, -0.0007, -0.0011, -0.0014, -0.0012, -0.0002, 0.0015, 0.0038, 0.0068, 0.0105, 0.0149, 0.0198, 0.0254, 0.0318, 0.0391, 0.0471, 0.0569, 0.0695, 0.0854, 0.1059, 0.1286, 0.1526, 0.1747, 0.1911, 0.2032, 0.2108, 0.2147, 0.2149, 0.2118, 0.2059, 0.1970, 0.1852, 0.1709, 0.1543, 0.1361, 0.1169, 0.0975, 0.0791, 0.0625, 0.0478, 0.0356, 0.0258, 0.0183, 0.0125, 0.0083, 0.0054, 0.0033, 0.0020, 0.0012, 0.0007, 0.0004, 0.0002, 0.0001, 0.0001, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000 };
//const float CIE_B[81] = { 0.0012, 0.0019, 0.0036, 0.0065, 0.0121, 0.0197, 0.0371, 0.0664, 0.1154, 0.1858, 0.2477, 0.2901, 0.3123, 0.3186, 0.3167, 0.3117, 0.2982, 0.2730, 0.2299, 0.1859, 0.1449, 0.1097, 0.0826, 0.0625, 0.0478, 0.0369, 0.0270, 0.0184, 0.0122, 0.0083, 0.0055, 0.0032, 0.0015, 0.0002, -0.0006, -0.0011, -0.0013, -0.0014, -0.0014, -0.0012, -0.0011, -0.0009, -0.0008, -0.0006, -0.0005, -0.0004, -0.0003, -0.0002, -0.0002, -0.0001, -0.0001, -0.0001, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000 };

const double CIE_X[81] = { 0.000159952, 0.00066244, 0.0023616, 0.0072423, 0.0191097, 0.0434, 0.084736, 0.140638, 0.204492, 0.264737, 0.314679, 0.357719, 0.383734, 0.386726, 0.370702, 0.342957, 0.302273, 0.254085, 0.195618, 0.132349, 0.080507, 0.041072, 0.016172, 0.005132, 0.003816, 0.015444, 0.037465, 0.071358, 0.117749, 0.172953, 0.236491, 0.304213, 0.376772, 0.451584, 0.529826, 0.616053, 0.705224, 0.793832, 0.878655, 0.951162, 1.01416, 1.0743, 1.11852, 1.1343, 1.12399, 1.0891, 1.03048, 0.95074, 0.856297, 0.75493, 0.647467, 0.53511, 0.431567, 0.34369, 0.268329, 0.2043, 0.152568, 0.11221, 0.0812606, 0.05793, 0.0408508, 0.028623, 0.0199413, 0.013842, 0.00957688, 0.0066052, 0.00455263, 0.0031447, 0.00217496, 0.0015057, 0.00104476, 0.00072745, 0.000508258, 0.00035638, 0.000250969, 0.00017773, 0.00012639, 0.000090151, 0.0000645258, 0.000046339, 0.0000334117 };
const double CIE_Y[81] = { 0.000017364, 0.00007156, 0.0002534, 0.0007685, 0.0020044, 0.004509, 0.008756, 0.014456, 0.021391, 0.029497, 0.038676, 0.049602, 0.062077, 0.074704, 0.089456, 0.106256, 0.128201, 0.152761, 0.18519, 0.21994, 0.253589, 0.297665, 0.339133, 0.395379, 0.460777, 0.53136, 0.606741, 0.68566, 0.761757, 0.82333, 0.875211, 0.92381, 0.961988, 0.9822, 0.991761, 0.99911, 0.99734, 0.98238, 0.955552, 0.915175, 0.868934, 0.825623, 0.777405, 0.720353, 0.658341, 0.593878, 0.527963, 0.461834, 0.398057, 0.339554, 0.283493, 0.228254, 0.179828, 0.140211, 0.107633, 0.081187, 0.060281, 0.044096, 0.0318004, 0.0226017, 0.0159051, 0.0111303, 0.0077488, 0.0053751, 0.00371774, 0.00256456, 0.00176847, 0.00122239, 0.00084619, 0.00058644, 0.00040741, 0.000284041, 0.00019873, 0.00013955, 0.000098428, 0.000069819, 0.000049737, 0.0000355405, 0.000025486, 0.0000183384, 0.000013249 };
const double CIE_Z[81] = { 0.000704776, 0.0029278, 0.0104822, 0.032344, 0.0860109, 0.19712, 0.389366, 0.65676, 0.972542, 1.2825, 1.55348, 1.7985, 1.96728, 2.0273, 1.9948, 1.9007, 1.74537, 1.5549, 1.31756, 1.0302, 0.772125, 0.5706, 0.415254, 0.302356, 0.218502, 0.159249, 0.112044, 0.082248, 0.060709, 0.04305, 0.030451, 0.020584, 0.013676, 0.007918, 0.003988, 0.001091, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };

const double CIE_D65[81] = { 49.975500, 52.311800, 54.648200, 68.701500, 82.754900, 87.120400, 91.486000, 92.458900, 93.431800, 90.057000, 86.682300, 95.773600, 104.865000, 110.936000, 117.008000, 117.410000, 117.812000, 116.336000, 114.861000, 115.392000, 115.923000, 112.367000, 108.811000, 109.082000, 109.354000, 108.578000, 107.802000, 106.296000, 104.790000, 106.239000, 107.689000, 106.047000, 104.405000, 104.225000, 104.046000, 102.023000, 100.000000, 98.167100, 96.334200, 96.061100, 95.788000, 92.236800, 88.685600, 89.345900, 90.006200, 89.802600, 89.599100, 88.648900, 87.698700, 85.493600, 83.288600, 83.493900, 83.699200, 81.863000, 80.026800, 80.120700, 80.214600, 81.246200, 82.277800, 80.281000, 78.284200, 74.002700, 69.721300, 70.665200, 71.609100, 72.979000, 74.349000, 67.976500, 61.604000, 65.744800, 69.885600, 72.486300, 75.087000, 69.339800, 63.592700, 55.005400, 46.418200, 56.611800, 66.805400, 65.094100, 63.382800 };
const double CIE_D50[81] = { 24.488, 27.179, 29.871, 39.589, 49.308, 52.910, 56.513, 58.273, 60.034, 58.926, 57.818, 66.321, 74.825, 81.036, 87.247, 88.930, 90.612, 90.990, 91.368, 93.238, 95.109, 93.536, 91.963, 93.843, 95.724, 96.169, 96.613, 96.871, 97.129, 99.614, 102.099, 101.427, 100.755, 101.536, 102.317, 101.159, 100.000, 98.868, 97.735, 98.327, 98.918, 96.208, 93.499, 95.593, 97.688, 98.478, 99.269, 99.155, 99.042, 97.382, 95.722, 97.290, 98.857, 97.262, 95.667, 96.929, 98.190, 100.597, 103.003, 101.068, 99.133, 93.257, 87.381, 89.492, 91.604, 92.246, 92.889, 84.872, 76.854, 81.683, 86.511, 89.546, 92.580, 85.405, 78.230, 67.961, 57.692, 70.307, 82.923, 80.599, 78.274 };

#define CIE_1964_Y_D65 11620.4
#define CIE_1964_Y_D50 11401.295

void SphereMie(double x, Complex m, pComplex s1, pComplex s2, double *q_sca, double *q_ext);

inline double BlackRadiation(double temperature, double omega);

#endif